
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Writing Your First Chaincode &#8212; hyperledger-fabricdocs master documentation</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Running chaincode in development mode" href="peer-chaincode-devmode.html" />
    <link rel="prev" title="Updating a channel configuration" href="config_update.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="index.html">
    
      <p class="title">hyperledger-fabricdocs</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="intro.html">Introduction</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="whatsnew.html">What’s new in Hyperledger Fabric v2.x</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="key_concepts.html">Key Concepts</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="getting_started.html">Getting Started - Install</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="getting_started_run_fabric.html">Getting Started - Run Fabric</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="developapps/developing_applications.html">Developing Applications</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="tutorials.html">Tutorials</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="deployment_guide_overview.html">Deploying a production network</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="ops_guide.html">Operations Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="upgrade.html">Upgrading to the latest release</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="command_ref.html">Commands Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="architecture.html">Architecture Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="Fabric-FAQ.html">Frequently Asked Questions</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="CONTRIBUTING.html">Contributions Welcome!</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="glossary.html">Glossary</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="releases.html">Releases</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="questions.html">Still Have Questions?</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="status.html">Status</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="test_network.html">Using the Fabric test network</a>
                </li>
            
          
            
                <li class="">
                    <a href="deploy_chaincode.html">Deploying a smart contract to a channel</a>
                </li>
            
          
            
                <li class="">
                    <a href="write_first_app.html">Running a Fabric Application</a>
                </li>
            
          
            
                <li class="">
                    <a href="tutorial/commercial_paper.html">Commercial paper tutorial</a>
                </li>
            
          
            
                <li class="">
                    <a href="private_data_tutorial.html">Using Private Data in Fabric</a>
                </li>
            
          
            
                <li class="">
                    <a href="secured_asset_transfer/secured_private_asset_transfer_tutorial.html">Secured asset transfer in Fabric</a>
                </li>
            
          
            
                <li class="">
                    <a href="couchdb_tutorial.html">Using CouchDB</a>
                </li>
            
          
            
                <li class="">
                    <a href="create_channel/create_channel_overview.html">Creating a channel</a>
                </li>
            
          
            
                <li class="">
                    <a href="channel_update_tutorial.html">Adding an Org to a Channel</a>
                </li>
            
          
            
                <li class="">
                    <a href="config_update.html">Updating a channel configuration</a>
                </li>
            
          
            
                <li class="active">
                    <a href="">Writing Your First Chaincode</a>
                </li>
            
          
            
                <li class="">
                    <a href="peer-chaincode-devmode.html">Running chaincode in development mode</a>
                </li>
            
          
            
                <li class="">
                    <a href="videos.html">Videos</a>
                </li>
            
          
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#what-is-chaincode" class="nav-link">What is Chaincode?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#fabric-contract-api" class="nav-link">Fabric Contract API</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#asset-transfer-chaincode" class="nav-link">Asset Transfer Chaincode</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#choosing-a-location-for-the-code" class="nav-link">Choosing a Location for the Code</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#housekeeping" class="nav-link">Housekeeping</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#initializing-the-chaincode" class="nav-link">Initializing the Chaincode</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#pulling-it-all-together" class="nav-link">Pulling it All Together</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#chaincode-access-control" class="nav-link">Chaincode access control</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#managing-external-dependencies-for-chaincode-written-in-go" class="nav-link">Managing external dependencies for chaincode written in Go</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="writing-your-first-chaincode">
<h1>Writing Your First Chaincode<a class="headerlink" href="#writing-your-first-chaincode" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-chaincode">
<h2>What is Chaincode?<a class="headerlink" href="#what-is-chaincode" title="Permalink to this headline">¶</a></h2>
<p>Chaincode is a program, written in <a class="reference external" href="https://golang.org">Go</a>, <a class="reference external" href="https://nodejs.org">Node.js</a>,
or <a class="reference external" href="https://java.com/en/">Java</a> that implements a prescribed interface.
Chaincode runs in a separate process from the peer and initializes and manages
the ledger state through transactions submitted by applications.</p>
<p>A chaincode typically handles business logic agreed to by members of the
network, so it similar to a “smart contract”. A chaincode can be invoked to update or query
the ledger in a proposal transaction. Given the appropriate permission, a chaincode
may invoke another chaincode, either in the same channel or in different channels, to access its state.
Note that, if the called chaincode is on a different channel from the calling chaincode,
only read query is allowed. That is, the called chaincode on a different channel is only a <code class="docutils literal notranslate"><span class="pre">Query</span></code>,
which does not participate in state validation checks in subsequent commit phase.</p>
<p>In the following sections, we will explore chaincode through the eyes of an
application developer. We’ll present a asset-transfer chaincode sample walkthrough,
and the purpose of each method in the Fabric Contract API. If you
are a network operator who is deploying a chaincode to running network,
visit the <a class="reference internal" href="deploy_chaincode.html"><span class="doc">Deploying a smart contract to a channel</span></a> tutorial and the <a class="reference internal" href="chaincode_lifecycle.html"><span class="doc">Fabric chaincode lifecycle</span></a>
concept topic.</p>
<p>This tutorial provides an overview of the high level APIs provided by the Fabric Contract API.
To learn more about developing smart contracts using the Fabric contract API, visit the <a class="reference internal" href="developapps/smartcontract.html"><span class="doc">Smart Contract Processing</span></a> topic.</p>
</div>
<div class="section" id="fabric-contract-api">
<h2>Fabric Contract API<a class="headerlink" href="#fabric-contract-api" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">fabric-contract-api</span></code> provides the contract interface, a high level API for application developers to implement Smart Contracts.
Within Hyperledger Fabric, Smart Contracts are also known as Chaincode. Working with this API provides a high level entry point to writing business logic.
Documentation of the Fabric Contract API for different languages can be found at the links below:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-contract-api-go/contractapi">Go</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-node/{BRANCH}/api/">Node.js</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-java/{BRANCH}/api/org/hyperledger/fabric/contract/package-summary.html">Java</a></p></li>
</ul>
</div></blockquote>
<p>Note that when using the contract api, each chaincode function that is called is passed a transaction context “ctx”, from which
you can get the chaincode stub (GetStub() ), which has functions to access the ledger (e.g. GetState() ) and make requests
to update the ledger (e.g. PutState() ). You can learn more at the language-specific links below.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#Chaincode">Go</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-node/{BRANCH}/api/fabric-shim.ChaincodeInterface.html">Node.js</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-java/{BRANCH}/api/org/hyperledger/fabric/shim/Chaincode.html">Java</a></p></li>
</ul>
</div></blockquote>
<p>In this tutorial using Go chaincode, we will demonstrate the use of these APIs
by implementing a asset-transfer chaincode application that manages simple “assets”.</p>
</div>
<div class="section" id="asset-transfer-chaincode">
<span id="id1"></span><h2>Asset Transfer Chaincode<a class="headerlink" href="#asset-transfer-chaincode" title="Permalink to this headline">¶</a></h2>
<p>Our application is a basic sample chaincode to initialize a ledger with assets, create, read, update, and delete assets, check to see
if an asset exists, and transfer assets from one owner to another.</p>
<div class="section" id="choosing-a-location-for-the-code">
<h3>Choosing a Location for the Code<a class="headerlink" href="#choosing-a-location-for-the-code" title="Permalink to this headline">¶</a></h3>
<p>If you haven’t been doing programming in Go, you may want to make sure that
you have <a class="reference external" href="https://golang.org">Go</a> installed and your system properly configured. We assume
you are using a version that supports modules.</p>
<p>Now, you will want to create a directory for your chaincode application.</p>
<p>To keep things simple, let’s use the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>// atcc is shorthand <span class="k">for</span> asset transfer chaincode
mkdir atcc <span class="o">&amp;&amp;</span> <span class="nb">cd</span> atcc
</pre></div>
</div>
<p>Now, let’s create the module and the source file that we’ll fill in with code:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>go mod init atcc
touch atcc.go
</pre></div>
</div>
</div>
<div class="section" id="housekeeping">
<h3>Housekeeping<a class="headerlink" href="#housekeeping" title="Permalink to this headline">¶</a></h3>
<p>First, let’s start with some housekeeping. As with every chaincode, it implements the
<a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-contract-api-go/contractapi">fabric-contract-api interface</a>,
so let’s add the Go import statements for the necessary dependencies for our chaincode. We’ll import the
fabric contract api package and define our SmartContract.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&quot;fmt&quot;</span>
  <span class="s">&quot;log&quot;</span>
  <span class="s">&quot;github.com/hyperledger/fabric-contract-api-go/contractapi&quot;</span>
<span class="p">)</span>

<span class="c1">// SmartContract provides functions for managing an Asset</span>
<span class="kd">type</span> <span class="nx">SmartContract</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">contractapi</span><span class="p">.</span><span class="nx">Contract</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, let’s add a struct <code class="docutils literal notranslate"><span class="pre">Asset</span></code> to represent simple assets on the ledger.
Note the JSON annotations, which will be used to marshal the asset to JSON which is stored on the ledger.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Asset describes basic details of what makes up a simple asset</span>
<span class="kd">type</span> <span class="nx">Asset</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">ID</span>             <span class="kt">string</span> <span class="s">`json:&quot;ID&quot;`</span>
  <span class="nx">Color</span>          <span class="kt">string</span> <span class="s">`json:&quot;color&quot;`</span>
  <span class="nx">Size</span>           <span class="kt">int</span>    <span class="s">`json:&quot;size&quot;`</span>
  <span class="nx">Owner</span>          <span class="kt">string</span> <span class="s">`json:&quot;owner&quot;`</span>
  <span class="nx">AppraisedValue</span> <span class="kt">int</span>    <span class="s">`json:&quot;appraisedValue&quot;`</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="initializing-the-chaincode">
<h3>Initializing the Chaincode<a class="headerlink" href="#initializing-the-chaincode" title="Permalink to this headline">¶</a></h3>
<p>Next, we’ll implement the <code class="docutils literal notranslate"><span class="pre">InitLedger</span></code> function to populate the ledger with some initial data.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// InitLedger adds a base set of assets to the ledger</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">InitLedger</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">assets</span> <span class="o">:=</span> <span class="p">[]</span><span class="nx">Asset</span><span class="p">{</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset1&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Tomoko&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">300</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset2&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Brad&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">400</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset3&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Jin Soo&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">500</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset4&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Max&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">600</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset5&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Adriana&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">700</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset6&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;white&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Michel&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">800</span><span class="p">},</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">asset</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">assets</span> <span class="p">{</span>
    <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">err</span>
    <span class="p">}</span>

    <span class="nx">err</span> <span class="p">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">asset</span><span class="p">.</span><span class="nx">ID</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to put to world state. %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">nil</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, we write a function to create an asset on the ledger that does not yet exist. When writing chaincode, it
is a good idea to check for the existence of something on the ledger prior to taking an action on it, as is demonstrated
in the <code class="docutils literal notranslate"><span class="pre">CreateAsset</span></code> function below.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// CreateAsset issues a new asset to the world state with given details.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">CreateAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">color</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">size</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">owner</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">appraisedValue</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">exists</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="nx">exists</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s already exists&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">asset</span> <span class="o">:=</span> <span class="nx">Asset</span><span class="p">{</span>
    <span class="nx">ID</span><span class="p">:</span>             <span class="nx">id</span><span class="p">,</span>
    <span class="nx">Color</span><span class="p">:</span>          <span class="nx">color</span><span class="p">,</span>
    <span class="nx">Size</span><span class="p">:</span>           <span class="nx">size</span><span class="p">,</span>
    <span class="nx">Owner</span><span class="p">:</span>          <span class="nx">owner</span><span class="p">,</span>
    <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="nx">appraisedValue</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now that we have populated the ledger with some initial assets and created an asset,
let’s write a function <code class="docutils literal notranslate"><span class="pre">ReadAsset</span></code> that allows us to read an asset from the ledger.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// ReadAsset returns the asset stored in the world state with given id.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">ReadAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="nx">Asset</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">GetState</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to read from world state: %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="nx">assetJSON</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s does not exist&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">asset</span> <span class="nx">Asset</span>
  <span class="nx">err</span> <span class="p">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">assetJSON</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">,</span> <span class="kc">nil</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now that we have assets on our ledger we can interact with, let’s write a chaincode function
<code class="docutils literal notranslate"><span class="pre">UpdateAsset</span></code> that allows us to update attributes of the asset that we are allowed to change.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// UpdateAsset updates an existing asset in the world state with provided parameters.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">UpdateAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">color</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">size</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">owner</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">appraisedValue</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">exists</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">!</span><span class="nx">exists</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s does not exist&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// overwriting original asset with new asset</span>
  <span class="nx">asset</span> <span class="o">:=</span> <span class="nx">Asset</span><span class="p">{</span>
    <span class="nx">ID</span><span class="p">:</span>             <span class="nx">id</span><span class="p">,</span>
    <span class="nx">Color</span><span class="p">:</span>          <span class="nx">color</span><span class="p">,</span>
    <span class="nx">Size</span><span class="p">:</span>           <span class="nx">size</span><span class="p">,</span>
    <span class="nx">Owner</span><span class="p">:</span>          <span class="nx">owner</span><span class="p">,</span>
    <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="nx">appraisedValue</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There may be cases where we need the ability to delete an asset from the ledger,
so let’s write a <code class="docutils literal notranslate"><span class="pre">DeleteAsset</span></code> function to handle that requirement.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// DeleteAsset deletes an given asset from the world state.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">DeleteAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">exists</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">!</span><span class="nx">exists</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s does not exist&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">DelState</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We said earlier that is was a good idea to check to see if an asset exists before
taking an action on it, so let’s write a function called <code class="docutils literal notranslate"><span class="pre">AssetExists</span></code> to implement that requirement.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// AssetExists returns true when asset with given ID exists in world state</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">GetState</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to read from world state: %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">assetJSON</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, we’ll write a function we’ll call <code class="docutils literal notranslate"><span class="pre">TransferAsset</span></code> that enables the transfer of an asset from one owner to another.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// TransferAsset updates the owner field of asset with given id in world state.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">TransferAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">newOwner</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">asset</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">ReadAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="nx">asset</span><span class="p">.</span><span class="nx">Owner</span> <span class="p">=</span> <span class="nx">newOwner</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let’s write a function we’ll call <code class="docutils literal notranslate"><span class="pre">GetAllAssets</span></code> that enables the querying of the ledger to
return all of the assets on the ledger.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// GetAllAssets returns all assets found in world state</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">GetAllAssets</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">)</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Asset</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// range query with empty string for startKey and endKey does an</span>
  <span class="c1">// open-ended query of all assets in the chaincode namespace.</span>
  <span class="nx">resultsIterator</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">GetStateByRange</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">defer</span> <span class="nx">resultsIterator</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>

  <span class="kd">var</span> <span class="nx">assets</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Asset</span>
  <span class="k">for</span> <span class="nx">resultsIterator</span><span class="p">.</span><span class="nx">HasNext</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">queryResponse</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">resultsIterator</span><span class="p">.</span><span class="nx">Next</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">asset</span> <span class="nx">Asset</span>
    <span class="nx">err</span> <span class="p">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">queryResponse</span><span class="p">.</span><span class="nx">Value</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>
    <span class="nx">assets</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">assets</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">assets</span><span class="p">,</span> <span class="kc">nil</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note" id="chaincode-sample">
<p class="admonition-title">Note</p>
<p>The full chaincode sample below is presented as a way to
to keep this tutorial as clear and straightforward as possible. In a
real-world implementation, it is likely that packages will be segmented
where a <code class="docutils literal notranslate"><span class="pre">main</span></code> package imports the chaincode package to allow for easy unit testing.
To see what this looks like, see the asset-transfer <a class="reference external" href="https://github.com/hyperledger/fabric-samples/tree/master/asset-transfer-basic/chaincode-go">Go chaincode</a>
in fabric-samples. If you look at <code class="docutils literal notranslate"><span class="pre">assetTransfer.go</span></code>, you will see that
it contains <code class="docutils literal notranslate"><span class="pre">package</span> <span class="pre">main</span></code> and imports <code class="docutils literal notranslate"><span class="pre">package</span> <span class="pre">chaincode</span></code> defined in <code class="docutils literal notranslate"><span class="pre">smartcontract.go</span></code> and
located at <code class="docutils literal notranslate"><span class="pre">fabric-samples/asset-transfer-basic/chaincode-go/chaincode/</span></code>.</p>
</div>
</div>
<div class="section" id="pulling-it-all-together">
<h3>Pulling it All Together<a class="headerlink" href="#pulling-it-all-together" title="Permalink to this headline">¶</a></h3>
<p>Finally, we need to add the <code class="docutils literal notranslate"><span class="pre">main</span></code> function, which will call the
<a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-contract-api-go/contractapi#ContractChaincode.Start">ContractChaincode.Start</a>
function. Here’s the whole chaincode program source.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&quot;encoding/json&quot;</span>
  <span class="s">&quot;fmt&quot;</span>
  <span class="s">&quot;log&quot;</span>

  <span class="s">&quot;github.com/hyperledger/fabric-contract-api-go/contractapi&quot;</span>
<span class="p">)</span>

<span class="c1">// SmartContract provides functions for managing an Asset</span>
<span class="kd">type</span> <span class="nx">SmartContract</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">contractapi</span><span class="p">.</span><span class="nx">Contract</span>
<span class="p">}</span>

<span class="c1">// Asset describes basic details of what makes up a simple asset</span>
<span class="kd">type</span> <span class="nx">Asset</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">ID</span>             <span class="kt">string</span> <span class="s">`json:&quot;ID&quot;`</span>
  <span class="nx">Color</span>          <span class="kt">string</span> <span class="s">`json:&quot;color&quot;`</span>
  <span class="nx">Size</span>           <span class="kt">int</span>    <span class="s">`json:&quot;size&quot;`</span>
  <span class="nx">Owner</span>          <span class="kt">string</span> <span class="s">`json:&quot;owner&quot;`</span>
  <span class="nx">AppraisedValue</span> <span class="kt">int</span>    <span class="s">`json:&quot;appraisedValue&quot;`</span>
<span class="p">}</span>

<span class="c1">// InitLedger adds a base set of assets to the ledger</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">InitLedger</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">assets</span> <span class="o">:=</span> <span class="p">[]</span><span class="nx">Asset</span><span class="p">{</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset1&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Tomoko&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">300</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset2&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Brad&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">400</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset3&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Jin Soo&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">500</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset4&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Max&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">600</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset5&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Adriana&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">700</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">ID</span><span class="p">:</span> <span class="s">&quot;asset6&quot;</span><span class="p">,</span> <span class="nx">Color</span><span class="p">:</span> <span class="s">&quot;white&quot;</span><span class="p">,</span> <span class="nx">Size</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="nx">Owner</span><span class="p">:</span> <span class="s">&quot;Michel&quot;</span><span class="p">,</span> <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="mi">800</span><span class="p">},</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">asset</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">assets</span> <span class="p">{</span>
    <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">err</span>
    <span class="p">}</span>

    <span class="nx">err</span> <span class="p">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">asset</span><span class="p">.</span><span class="nx">ID</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to put to world state. %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// CreateAsset issues a new asset to the world state with given details.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">CreateAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">color</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">size</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">owner</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">appraisedValue</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">exists</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="nx">exists</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s already exists&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">asset</span> <span class="o">:=</span> <span class="nx">Asset</span><span class="p">{</span>
    <span class="nx">ID</span><span class="p">:</span>             <span class="nx">id</span><span class="p">,</span>
    <span class="nx">Color</span><span class="p">:</span>          <span class="nx">color</span><span class="p">,</span>
    <span class="nx">Size</span><span class="p">:</span>           <span class="nx">size</span><span class="p">,</span>
    <span class="nx">Owner</span><span class="p">:</span>          <span class="nx">owner</span><span class="p">,</span>
    <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="nx">appraisedValue</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// ReadAsset returns the asset stored in the world state with given id.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">ReadAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="nx">Asset</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">GetState</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to read from world state: %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="nx">assetJSON</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s does not exist&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">asset</span> <span class="nx">Asset</span>
  <span class="nx">err</span> <span class="p">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">assetJSON</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">,</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// UpdateAsset updates an existing asset in the world state with provided parameters.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">UpdateAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">color</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">size</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">owner</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">appraisedValue</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">exists</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">!</span><span class="nx">exists</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s does not exist&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// overwriting original asset with new asset</span>
  <span class="nx">asset</span> <span class="o">:=</span> <span class="nx">Asset</span><span class="p">{</span>
    <span class="nx">ID</span><span class="p">:</span>             <span class="nx">id</span><span class="p">,</span>
    <span class="nx">Color</span><span class="p">:</span>          <span class="nx">color</span><span class="p">,</span>
    <span class="nx">Size</span><span class="p">:</span>           <span class="nx">size</span><span class="p">,</span>
    <span class="nx">Owner</span><span class="p">:</span>          <span class="nx">owner</span><span class="p">,</span>
    <span class="nx">AppraisedValue</span><span class="p">:</span> <span class="nx">appraisedValue</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// DeleteAsset deletes an given asset from the world state.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">DeleteAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">exists</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">!</span><span class="nx">exists</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;the asset %s does not exist&quot;</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">DelState</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// AssetExists returns true when asset with given ID exists in world state</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">AssetExists</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">GetState</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to read from world state: %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">assetJSON</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// TransferAsset updates the owner field of asset with given id in world state.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">TransferAsset</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span> <span class="nx">id</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">newOwner</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
  <span class="nx">asset</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">ReadAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="nx">asset</span><span class="p">.</span><span class="nx">Owner</span> <span class="p">=</span> <span class="nx">newOwner</span>
  <span class="nx">assetJSON</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Marshal</span><span class="p">(</span><span class="nx">asset</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">err</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">assetJSON</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// GetAllAssets returns all assets found in world state</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span> <span class="nx">GetAllAssets</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">)</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Asset</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// range query with empty string for startKey and endKey does an</span>
  <span class="c1">// open-ended query of all assets in the chaincode namespace.</span>
  <span class="nx">resultsIterator</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">GetStub</span><span class="p">().</span><span class="nx">GetStateByRange</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
  <span class="p">}</span>
  <span class="k">defer</span> <span class="nx">resultsIterator</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>

  <span class="kd">var</span> <span class="nx">assets</span> <span class="p">[]</span><span class="o">*</span><span class="nx">Asset</span>
  <span class="k">for</span> <span class="nx">resultsIterator</span><span class="p">.</span><span class="nx">HasNext</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">queryResponse</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">resultsIterator</span><span class="p">.</span><span class="nx">Next</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">asset</span> <span class="nx">Asset</span>
    <span class="nx">err</span> <span class="p">=</span> <span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">queryResponse</span><span class="p">.</span><span class="nx">Value</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span>
    <span class="p">}</span>
    <span class="nx">assets</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">assets</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">asset</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">assets</span><span class="p">,</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">assetChaincode</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">contractapi</span><span class="p">.</span><span class="nx">NewChaincode</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">SmartContract</span><span class="p">{})</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Panicf</span><span class="p">(</span><span class="s">&quot;Error creating asset-transfer-basic chaincode: %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">assetChaincode</span><span class="p">.</span><span class="nx">Start</span><span class="p">();</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">log</span><span class="p">.</span><span class="nx">Panicf</span><span class="p">(</span><span class="s">&quot;Error starting asset-transfer-basic chaincode: %v&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="chaincode-access-control">
<h2>Chaincode access control<a class="headerlink" href="#chaincode-access-control" title="Permalink to this headline">¶</a></h2>
<p>Chaincode can utilize the client (submitter) certificate for access
control decisions with <code class="docutils literal notranslate"><span class="pre">ctx.GetStub().GetCreator()</span></code>. Additionally
the Fabric Contract API provides extension APIs that extract client identity
from the submitter’s certificate that can be used for access control decisions,
whether that is based on client identity itself, or the org identity,
or on a client identity attribute.</p>
<p>For example an asset that is represented as a key/value may include the
client’s identity as part of the value (for example as a JSON attribute
indicating that asset owner), and only this client may be authorized
to make updates to the key/value in the future. The client identity
library extension APIs can be used within chaincode to retrieve this
submitter information to make such access control decisions.</p>
</div>
<div class="section" id="managing-external-dependencies-for-chaincode-written-in-go">
<span id="vendoring"></span><h2>Managing external dependencies for chaincode written in Go<a class="headerlink" href="#managing-external-dependencies-for-chaincode-written-in-go" title="Permalink to this headline">¶</a></h2>
<p>Your Go chaincode depends on Go packages (like the chaincode shim) that are not
part of the standard library. The source to these packages must be included in
your chaincode package when it is installed to a peer. If you have structured
your chaincode as a module, the easiest way to do this is to “vendor” the
dependencies with <code class="docutils literal notranslate"><span class="pre">go</span> <span class="pre">mod</span> <span class="pre">vendor</span></code> before packaging your chaincode.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>go mod tidy
go mod vendor
</pre></div>
</div>
<p>This places the external dependencies for your chaincode into a local <code class="docutils literal notranslate"><span class="pre">vendor</span></code>
directory.</p>
<p>Once dependencies are vendored in your chaincode directory, <code class="docutils literal notranslate"><span class="pre">peer</span> <span class="pre">chaincode</span> <span class="pre">package</span></code>
and <code class="docutils literal notranslate"><span class="pre">peer</span> <span class="pre">chaincode</span> <span class="pre">install</span></code> operations will then include code associated with the
dependencies into the chaincode package.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="config_update.html" title="previous page">Updating a channel configuration</a>
    <a class='right-next' id="next-link" href="peer-chaincode-devmode.html" title="next page">Running chaincode in development mode</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
  </body>
</html>