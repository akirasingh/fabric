
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Membership Service Provider (MSP) &#8212; hyperledger-fabricdocs master documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Policies" href="../policies/policies.html" />
    <link rel="prev" title="Identity" href="../identity/identity.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <p class="title">hyperledger-fabricdocs</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../intro.html">Introduction</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../whatsnew.html">What’s new in Hyperledger Fabric v2.x</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../key_concepts.html">Key Concepts</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../getting_started.html">Getting Started - Install</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../getting_started_run_fabric.html">Getting Started - Run Fabric</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../developapps/developing_applications.html">Developing Applications</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../tutorials.html">Tutorials</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../deployment_guide_overview.html">Deploying a production network</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../ops_guide.html">Operations Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../upgrade.html">Upgrading to the latest release</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../command_ref.html">Commands Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../architecture.html">Architecture Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../Fabric-FAQ.html">Frequently Asked Questions</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../CONTRIBUTING.html">Contributions Welcome!</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../glossary.html">Glossary</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../releases.html">Releases</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../questions.html">Still Have Questions?</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../status.html">Status</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="../blockchain.html">Introduction</a>
                </li>
            
          
            
                <li class="">
                    <a href="../fabric_model.html">Hyperledger Fabric Model</a>
                </li>
            
          
            
                <li class="">
                    <a href="../network/network.html">How Fabric networks are structured</a>
                </li>
            
          
            
                <li class="">
                    <a href="../identity/identity.html">Identity</a>
                </li>
            
          
            
                <li class="active">
                    <a href="">Membership Service Provider (MSP)</a>
                </li>
            
          
            
                <li class="">
                    <a href="../policies/policies.html">Policies</a>
                </li>
            
          
            
                <li class="">
                    <a href="../peers/peers.html">Peers</a>
                </li>
            
          
            
                <li class="">
                    <a href="../ledger/ledger.html">Ledger</a>
                </li>
            
          
            
                <li class="">
                    <a href="../orderer/ordering_service.html">The Ordering Service</a>
                </li>
            
          
            
                <li class="">
                    <a href="../smartcontract/smartcontract.html">Smart Contracts and Chaincode</a>
                </li>
            
          
            
                <li class="">
                    <a href="../chaincode_lifecycle.html">Fabric chaincode lifecycle</a>
                </li>
            
          
            
                <li class="">
                    <a href="../private-data/private-data.html">Private data</a>
                </li>
            
          
            
                <li class="">
                    <a href="../capabilities_concept.html">Channel capabilities</a>
                </li>
            
          
            
                <li class="">
                    <a href="../usecases.html">Use Cases</a>
                </li>
            
          
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#why-do-i-need-an-msp" class="nav-link">Why do I need an MSP?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#what-is-an-msp" class="nav-link">What is an MSP?</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#msp-domains" class="nav-link">MSP domains</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#local-msps" class="nav-link">Local MSPs</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#channel-msps" class="nav-link">Channel MSPs</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#what-role-does-an-organization-play-in-an-msp" class="nav-link">What role does an organization play in an MSP?</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#organizational-units-ous-and-msps" class="nav-link">Organizational Units (OUs) and MSPs</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#node-ou-roles-and-msps" class="nav-link">Node OU Roles and MSPs</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#msp-structure" class="nav-link">MSP Structure</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="membership-service-provider-msp">
<h1>Membership Service Provider (MSP)<a class="headerlink" href="#membership-service-provider-msp" title="Permalink to this headline">¶</a></h1>
<p>Note: this topic describes a network that does not use a “system channel”, a channel that the ordering service is bootstrapped with and the ordering service exclusively controls. Since the release of v2.3, using system channel is now considered the legacy process as compared to the process to <a class="reference external" href="../create_channel/create_channel_participation.html">Create a channel</a> without a system channel. For a version of this topic that includes information about the system channel, check out <a class="reference external" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/membership/membership.html">Membership Service Provider (MSP)</a> from the v2.2 documentation.</p>
<div class="section" id="why-do-i-need-an-msp">
<h2>Why do I need an MSP?<a class="headerlink" href="#why-do-i-need-an-msp" title="Permalink to this headline">¶</a></h2>
<p>Because Fabric is a permissioned network, blockchain participants need a way to prove their identity to the rest of the network in order to transact on the network. If you’ve read through the documentation on <a class="reference external" href="../identity/identity.html">Identity</a>
you’ve seen how a Public Key Infrastructure (PKI) can provide verifiable identities through a chain of trust. How is that chain of trust used by the blockchain network?</p>
<p>Certificate Authorities issue identities by generating a public and private key which forms a key-pair that can be used to prove identity. Because a private key can never be shared publicly, a mechanism is required to enable that proof which is where the MSP comes in. For example, a peer uses its private key to digitally sign, or endorse, a transaction.  The MSP on the ordering service contains the peer’s public key which is then used to verify that the signature attached to the transaction is valid. The private key is used to produce a signature on a transaction that only the corresponding public key, that is part of an MSP, can match. Thus, the MSP is the mechanism that allows that identity to be trusted and recognized by the rest of the network without ever revealing the member’s private key.</p>
<p>Recall from the credit card scenario in the Identity topic that the Certificate Authority is like a card provider — it dispenses many different types of verifiable identities. An MSP, on the other hand, determines which credit card providers are accepted at the store. In this way, the MSP turns an identity (the credit card) into a role (the ability to buy things at the store).</p>
<p>This ability to turn verifiable identities into roles is fundamental to the way Fabric networks function, since it allows organizations, nodes, and channels the ability establish MSPs that determine who is allowed to do what at the organization, node, and channel level.</p>
<p><img alt="MSP1a" src="../_images/membership.msp.diagram.png" /></p>
<p><em>Identities are similar to your credit cards that are used to prove you can pay. The MSP is similar to the list of accepted credit cards.</em></p>
<p>Consider a group of banks that operate a blockchain network. Each bank operates peer and ordering nodes, and the peers endorse transactions submitted to the network. However, each bank would also have departments and account holders. The account holders would belong to each organization, but would not run nodes on the network. They would only interact with the system from their mobile or web application. So how does the network recognize and differentiate these identities? A CA was used to create the identities, but like the card example, those identities can’t just be issued, they need to be recognized by the network. MSPs are used to define the organizations that are trusted by the network members. MSPs are also the mechanism that provide members with a set of roles and permissions within the network. Because the MSPs defining these organizations are known to the members of a network, they can then be used to validate that network entities that attempt to perform actions are allowed to.</p>
<p>Finally, consider if you want to join an <em>existing</em> network, you need a way to turn your identity into something that is recognized by the network. The MSP is the mechanism that enables you to participate on a permissioned blockchain network. To transact on a Fabric network a member needs to:</p>
<ol class="simple">
<li><p>Have an identity issued by a CA that is trusted by the network.</p></li>
<li><p>Become a member of an <em>organization</em> that is recognized and approved by the network members. The MSP is how the identity is linked to the membership of an organization. Membership is achieved by adding the member’s public key (also known as certificate, signing cert, or signcert) to the organization’s MSP.</p></li>
<li><p>Add the MSP to a channel.</p></li>
<li><p>Ensure the MSP is included in the <a class="reference external" href="../policies/policies.html">policy</a> definitions on the network.</p></li>
</ol>
</div>
<div class="section" id="what-is-an-msp">
<h2>What is an MSP?<a class="headerlink" href="#what-is-an-msp" title="Permalink to this headline">¶</a></h2>
<p>Despite its name, the Membership Service Provider does not actually provide anything. Rather, the implementation of the MSP requirement is a set of folders that are added to the configuration of the network and is used to define an organization both inwardly (organizations decide who its admins are) and outwardly (by allowing other organizations to validate that entities have the authority to do what they are attempting to do).  Whereas Certificate Authorities generate the certificates that represent identities, the MSP contains a list of permissioned identities.</p>
<p>The MSP identifies which Root CAs and Intermediate CAs are accepted to define the members of a trust domain by listing the identities of their members, or by identifying which CAs are authorized to issue valid identities for their members.</p>
<p>But the power of an MSP goes beyond simply listing who is a network participant or member of a channel. It is the MSP that turns an identity into a <strong>role</strong> by identifying specific privileges an actor has on a node or channel. Note that when a user is registered with a Fabric CA, a role of admin, peer, client, orderer, or member must be associated with the user. For example, identities registered with the “peer” role should, naturally, be given to a peer. Similarly, identities registered with the “admin” role should be given to organization admins. We’ll delve more into the significance of these roles later in the topic.</p>
<p>In addition, an MSP can allow for the identification of a list of identities that have been revoked — as discussed in the <a class="reference external" href="../identity/identity.html">Identity</a> documentation — but we will talk about how that process also extends to an MSP.</p>
</div>
<div class="section" id="msp-domains">
<h2>MSP domains<a class="headerlink" href="#msp-domains" title="Permalink to this headline">¶</a></h2>
<p>MSPs occur in two domains in a blockchain network:</p>
<ul class="simple">
<li><p>Locally on an actor’s node (<strong>local MSP</strong>)</p></li>
<li><p>In channel configuration (<strong>channel MSP</strong>)</p></li>
</ul>
<p>The key difference between local and channel MSPs is not how they function – both turn identities into roles – but their <strong>scope</strong>. Each MSP lists roles and permissions at a particular level of administration.</p>
<div class="section" id="local-msps">
<h3>Local MSPs<a class="headerlink" href="#local-msps" title="Permalink to this headline">¶</a></h3>
<p><strong>Local MSPs are defined for clients and for nodes (peers and orderers)</strong>.
Local MSPs define the permissions for a node (who are the peer admins who can operate the node, for example). The local MSPs of clients (the account holders in the banking scenario above), allow the user to authenticate itself in its transactions as a member of a channel (e.g. in chaincode transactions), or as the owner of a specific role into the system such as an organization admin, for example, in configuration transactions.</p>
<p><strong>Every node must have a local MSP defined</strong>, as it defines who has administrative or participatory rights at that level (peer admins will not necessarily be channel admins, and vice versa).  This allows for authenticating member messages outside the context of a channel and to define the permissions over a particular node (who has the ability to install chaincode on a peer, for example). Note that one or more nodes can be owned by an organization. An MSP defines the organization admins. And the organization, the admin of the organization, the admin of the node, and the node itself should all have the same root of trust.</p>
<p>An orderer local MSP is also defined on the file system of the node and only applies to that node. Like peer nodes, orderers are also owned by a single organization and therefore have a single MSP to list the actors or nodes it trusts.</p>
</div>
<div class="section" id="channel-msps">
<h3>Channel MSPs<a class="headerlink" href="#channel-msps" title="Permalink to this headline">¶</a></h3>
<p>In contrast, <strong>channel MSPs define administrative and participatory rights at the channel level</strong>. Peers and ordering nodes on an application channel share the same view of channel MSPs, and will therefore be able to correctly authenticate the channel participants. This means that if an organization wishes to join the channel, an MSP incorporating the chain of trust for the organization’s members would need to be included in the channel configuration. Otherwise transactions originating from this organization’s identities will be rejected. Whereas local MSPs are represented as a folder structure on the file system, channel MSPs are described in a channel configuration.</p>
<p><img alt="MSP1d" src="../_images/ChannelMSP.png" /></p>
<p><em>Snippet from a channel config.json file that includes two organization MSPs.</em></p>
<p><strong>Channel MSPs identify who has authorities at a channel level</strong>.
The channel MSP defines the <em>relationship</em> between the identities of channel members (which themselves are MSPs) and the enforcement of channel level policies. Channel MSPs contain the MSPs of the organizations of the channel members.</p>
<p><strong>Every organization participating in a channel must have an MSP defined for it</strong>. In fact, it is recommended that there is a one-to-one mapping between organizations and MSPs. The MSP defines which members are empowered to act on behalf of the organization. This includes configuration of the MSP itself as well as approving administrative tasks that the organization has role, such as adding new members to a channel. If all network members were part of a single organization or MSP, data privacy is sacrificed. Multiple organizations facilitate privacy by segregating ledger data to only channel members. If more granularity is required within an organization, the organization can be further divided into organizational units (OUs) which we describe in more detail later in this topic.</p>
<p><strong>The channel MSP includes the MSPs of all the organizations on a channel.</strong> This includes not just “peer organizations”, which own peers and invoke chaincodes, but the organizations that own and run the ordering service.</p>
<p><strong>Local MSPs are only defined on the file system of the node or user</strong> to which they apply. Therefore, physically and logically there is only one local MSP per node. However, as channel MSPs are available to all nodes in the channel, they are logically defined once in the channel configuration. However, <strong>a channel MSP is also instantiated on the file system of every node in the channel and kept synchronized via consensus</strong>. So while there is a copy of each channel MSP on the local file system of every node, logically a channel MSP resides on and is maintained by the channel or the network.</p>
<p>The following diagram illustrates how local and channel MSPs coexist on the network:</p>
<p><img alt="MSP3" src="../_images/membership.diagram.2.png" /></p>
<p><em>In this figure, ORG1, owns the ordering node joined to the channel. The MSPs related to ORG1, the local MSP of the node and the global MSP that formally represents ORG1 on the channel, have been created by RCA1, the CA for ORG1. The peer organization, ORG2, also has a local MSP for its peer and another global MSP that represents ORG2 on the channel. Both ORG1 and ORG2 are channel members, and manage the channel in their areas of administration, and trust identities created by each other’s CA. Note that in a production scenario, it is likely that there will be several peer organizations who collaborate in the administration of the channel, and potentially more than one orderer organization as well.</em></p>
</div>
</div>
<div class="section" id="what-role-does-an-organization-play-in-an-msp">
<h2>What role does an organization play in an MSP?<a class="headerlink" href="#what-role-does-an-organization-play-in-an-msp" title="Permalink to this headline">¶</a></h2>
<p>An <strong>organization</strong> is a logical managed group of members. This can be something as big as a multinational corporation or a small as a flower shop. What’s most important about organizations (or <strong>orgs</strong>) is that they manage their members under a single MSP. The MSP allows an identity to be linked to an organization. Note that this is different from the organization concept defined in an X.509 certificate, which we mentioned above.</p>
<p>The exclusive relationship between an organization and its MSP makes it sensible to name the MSP after the organization, a convention you’ll find adopted in most policy configurations. For example, organization <code class="docutils literal notranslate"><span class="pre">ORG1</span></code> would likely have an MSP called something like <code class="docutils literal notranslate"><span class="pre">ORG1-MSP</span></code>. In some cases an organization may require multiple membership groups — for example, where channels are used to perform very different business functions between organizations. In these cases it makes sense to have multiple MSPs and name them accordingly, e.g., <code class="docutils literal notranslate"><span class="pre">ORG2-MSP-NATIONAL</span></code> and <code class="docutils literal notranslate"><span class="pre">ORG2-MSP-GOVERNMENT</span></code>, reflecting the different membership roots of trust within <code class="docutils literal notranslate"><span class="pre">ORG2</span></code> in the <code class="docutils literal notranslate"><span class="pre">NATIONAL</span></code> sales channel compared to the <code class="docutils literal notranslate"><span class="pre">GOVERNMENT</span></code> regulatory channel.</p>
<div class="section" id="organizational-units-ous-and-msps">
<h3>Organizational Units (OUs) and MSPs<a class="headerlink" href="#organizational-units-ous-and-msps" title="Permalink to this headline">¶</a></h3>
<p>An organization can also be divided into multiple <strong>organizational units</strong>, each of which has a certain set of responsibilities, also referred to as <code class="docutils literal notranslate"><span class="pre">affiliations</span></code>. Think of an OU as a department inside an organization. For example, the <code class="docutils literal notranslate"><span class="pre">ORG1</span></code> organization might have both <code class="docutils literal notranslate"><span class="pre">ORG1.MANUFACTURING</span></code> and <code class="docutils literal notranslate"><span class="pre">ORG1.DISTRIBUTION</span></code> OUs to reflect these separate lines of business. When a CA issues X.509 certificates, the <code class="docutils literal notranslate"><span class="pre">OU</span></code> field in the certificate specifies the line of business to which the identity belongs. A benefit of using OUs like this is that these values can then be used in policy definitions in order to restrict access or in smart contracts for attribute-based access control. Otherwise, separate MSPs would need to be created for each organization.</p>
<p>Specifying OUs is optional. If OUs are not used, all of the identities that are part of an MSP — as identified by the Root CA and Intermediate CA folders — will be considered members of the organization.</p>
</div>
<div class="section" id="node-ou-roles-and-msps">
<h3>Node OU Roles and MSPs<a class="headerlink" href="#node-ou-roles-and-msps" title="Permalink to this headline">¶</a></h3>
<p>Additionally, there is a special kind of OU, sometimes referred to as a <code class="docutils literal notranslate"><span class="pre">Node</span> <span class="pre">OU</span></code>, that can be used to confer a role onto an identity. These Node OU roles are defined in the <code class="docutils literal notranslate"><span class="pre">$FABRIC_CFG_PATH/msp/config.yaml</span></code> file and contain a list of organizational units whose members are considered to be part of the organization represented by this MSP. This is particularly useful when you want to restrict the members of an organization to the ones holding an identity (signed by one of MSP designated CAs) with a specific Node OU role in it. For example, with node OU’s you can implement a more granular endorsement policy that requires Org1 peers to endorse a transaction, rather than any member of Org1.</p>
<p>In order to use the Node OU roles, the “identity classification” feature must be enabled for the network. When using the folder-based MSP structure, this is accomplished by enabling “Node OUs” in the config.yaml file which resides in the root of the MSP folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NodeOUs</span><span class="p">:</span>
  <span class="n">Enable</span><span class="p">:</span> <span class="n">true</span>
  <span class="n">ClientOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">client</span>
  <span class="n">PeerOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">peer</span>
  <span class="n">AdminOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">admin</span>
  <span class="n">OrdererOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">orderer</span>
</pre></div>
</div>
<p>In the example above, there are 4 possible Node OU <code class="docutils literal notranslate"><span class="pre">ROLES</span></code> for the MSP:</p>
<ul class="simple">
<li><p>client</p></li>
<li><p>peer</p></li>
<li><p>admin</p></li>
<li><p>orderer</p></li>
</ul>
<p>This convention allows you to distinguish MSP roles by the OU present in the CommonName attribute of the X509 certificate. The example above says that any certificate issued by cacerts/ca.sampleorg-cert.pem in which OU=client will identified as a client, OU=peer as a peer, etc. Starting with Fabric v1.4.3, there is also an OU for the orderer and for admins. The new admins role means that you no longer have to explicitly place certs in the admincerts folder of the MSP directory. Rather, the <code class="docutils literal notranslate"><span class="pre">admin</span></code> role present in the user’s signcert qualifies the identity as an admin user.</p>
<p>These Role and OU attributes are assigned to an identity when the Fabric CA or SDK is used to <code class="docutils literal notranslate"><span class="pre">register</span></code> a user with the CA. It is the subsequent <code class="docutils literal notranslate"><span class="pre">enroll</span></code> user command that generates the certificates in the users’ <code class="docutils literal notranslate"><span class="pre">/msp</span></code> folder.</p>
<p><img alt="MSP1c" src="../_images/ca-msp-visualization.png" /></p>
<p>The resulting ROLE and OU attributes are visible inside the X.509 signing certificate located in the <code class="docutils literal notranslate"><span class="pre">/signcerts</span></code> folder. The <code class="docutils literal notranslate"><span class="pre">ROLE</span></code> attribute is identified as <code class="docutils literal notranslate"><span class="pre">hf.Type</span></code> and  refers to an actor’s role within its organization, (specifying, for example, that an actor is a <code class="docutils literal notranslate"><span class="pre">peer</span></code>). See the following snippet from a signing certificate shows how the Roles and OUs are represented in the certificate.</p>
<p><img alt="MSP1d" src="../_images/signcert.png" /></p>
<p><strong>Note:</strong> For Channel MSPs, just because an actor has the role of an administrator it doesn’t mean that they can administer particular resources. The actual power a given identity has with respect to administering the system is determined by the <em>policies</em> that manage system resources. For example, a channel policy might specify that <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code> administrators, meaning identities with a role of <code class="docutils literal notranslate"><span class="pre">admin</span></code> and a Node OU of  <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code>, have the rights to add new organizations to the channel, whereas the <code class="docutils literal notranslate"><span class="pre">ORG1-DISTRIBUTION</span></code> administrators have no such rights.</p>
<p>Finally, OUs could be used by different organizations to distinguish each other. But in such cases, the different organizations have to use the same Root CAs and Intermediate CAs for their chain of trust, and assign the OU field to identify members of each organization. When every organization has the same CA or chain of trust, this makes the system more centralized than what might be desirable and therefore deserves careful consideration on a blockchain network.</p>
</div>
</div>
<div class="section" id="msp-structure">
<h2>MSP Structure<a class="headerlink" href="#msp-structure" title="Permalink to this headline">¶</a></h2>
<p>Let’s explore the MSP elements that render the functionality we’ve described so far.</p>
<p>A local MSP folder contains the following sub-folders:</p>
<p><img alt="MSP6" src="../_images/membership.diagram.6.png" /></p>
<p><em>The figure above shows the subfolders in a local MSP on the file system</em></p>
<ul>
<li><p><strong>config.yaml:</strong>  Used to configure the identity classification feature in Fabric by enabling “Node OUs” and defining the accepted roles.</p></li>
<li><p><strong>cacerts:</strong> This folder contains a list of self-signed X.509 certificates of the Root CAs trusted by the organization represented by this MSP. There must be at least one Root CA certificate in this MSP folder.</p>
<p>This is the most important folder because it identifies the CAs from which all other certificates must be derived to be considered members of the
corresponding organization to form the chain of trust.</p>
</li>
<li><p><strong>intermediatecerts:</strong> This folder contains a list of X.509 certificates of the Intermediate CAs trusted by this organization. Each certificate must be signed by one of the Root CAs in the MSP or by any Intermediate CA whose issuing CA chain ultimately leads back to a trusted Root CA.</p>
<p>An intermediate CA may represent a different subdivision of the organization (like <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code> and <code class="docutils literal notranslate"><span class="pre">ORG1-DISTRIBUTION</span></code> do for <code class="docutils literal notranslate"><span class="pre">ORG1</span></code>), or the
organization itself (as may be the case if a commercial CA is leveraged for the organization’s identity management). In the latter case intermediate CAs
can be used to represent organization subdivisions. <a class="reference external" href="../msp.html">Here</a> you may find more information on best practices for MSP configuration. Notice, that
it is possible to have a functioning network that does not have an Intermediate CA, in which case this folder would be empty.</p>
<p>Like the Root CA folder, this folder defines the CAs from which certificates must be issued to be considered members of the organization.</p>
</li>
<li><p><strong>admincerts (Deprecated from Fabric v1.4.3 and higher):</strong> This folder contains a list of identities that define the actors who have the role of administrators for this organization. In general, there should be one or more X.509 certificates in this list.</p>
<p><strong>Note:</strong> Prior to Fabric v1.4.3, admins were defined by explicitly putting certs in the <code class="docutils literal notranslate"><span class="pre">admincerts</span></code> folder in the local MSP directory of your peer. <strong>With Fabric v1.4.3 or higher, certificates in this folder are no longer required.</strong> Instead, it is recommended that when the user is registered with the CA, that the <code class="docutils literal notranslate"><span class="pre">admin</span></code> role is used to designate the node administrator. Then, the identity is recognized as an <code class="docutils literal notranslate"><span class="pre">admin</span></code> by the Node OU role value in their signcert. As a reminder, in order to leverage the admin role, the “identity classification” feature must be enabled in the config.yaml above by setting “Node OUs” to <code class="docutils literal notranslate"><span class="pre">Enable:</span> <span class="pre">true</span></code>. We’ll explore this more later.</p>
<p>And as a reminder, for Channel MSPs, just because an actor has the role of an administrator it doesn’t mean that they can administer particular resources. The actual power a given identity has with respect to administering the system is determined by the <em>policies</em> that manage system resources. For example, a channel policy might specify that <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code> administrators have the rights to add new organizations to the channel, whereas the <code class="docutils literal notranslate"><span class="pre">ORG1-DISTRIBUTION</span></code> administrators have no such rights.</p>
</li>
<li><p><strong>keystore: (private Key)</strong> This folder is defined for the local MSP of a peer or orderer node (or in a client’s local MSP), and contains the node’s private key. This key is used to sign data — for example to sign a transaction proposal response, as part of the endorsement phase.</p>
<p>This folder is mandatory for local MSPs, and must contain exactly one private key. Obviously, access to this folder must be limited only to the identities of users who have administrative responsibility on the peer.</p>
<p>The <strong>channel MSP</strong> configuration does not include this folder, because channel MSPs solely aim to offer identity validation functionalities and not signing abilities.</p>
<p><strong>Note:</strong> If you are using a <a class="reference external" href="../hsm.html">Hardware Security Module(HSM)</a> for key management, this folder is empty because the private key is generated by and stored in the HSM.</p>
</li>
<li><p><strong>signcert:</strong>  For a peer or orderer node (or in a client’s local MSP) this folder contains the node’s certificate issued by CA. The certificate represents the node’s identity, and this certificate’s corresponding <strong>private key</strong> can be used to generate signatures which may be verified by anyone with a copy of this certificate.</p>
<p>This folder is mandatory for local MSPs, and must contain exactly one <strong>public key</strong>. Obviously, access to this folder must be limited only to the identities of users who have administrative responsibility on the peer.</p>
<p>Configuration of a <strong>channel MSP</strong> does not include this folder, as channel MSPs solely aim to offer identity validation functionalities and not signing abilities.</p>
</li>
<li><p><strong>tlscacerts:</strong> This folder contains a list of self-signed X.509 certificates of the Root CAs trusted by this organization <strong>for secure communications between nodes using TLS</strong>. An example of a TLS communication would be when a peer needs to connect to an orderer so that it can receive ledger updates.</p>
<p>MSP TLS information relates to the nodes inside the network — the peers and the orderers, in other words, rather than the applications and administrations that consume the network.</p>
<p>There must be at least one TLS Root CA certificate in this folder. For more information about TLS, see <a class="reference external" href="../enable_tls.html">Securing Communication with Transport Layer Security (TLS)</a>.</p>
</li>
<li><p><strong>tlsintermediatecacerts:</strong> This folder contains a list intermediate CA certificates CAs trusted by the organization represented by this MSP <strong>for secure communications between nodes using TLS</strong>. This folder is specifically useful when commercial CAs are used for TLS certificates of an organization. Similar to membership intermediate CAs, specifying intermediate TLS CAs is optional.</p></li>
<li><p><strong>operationscerts:</strong> This folder contains the certificates required to communicate with the <a class="reference external" href="../operations_service.html">Fabric Operations Service</a> API.</p></li>
</ul>
<p>A channel MSP includes the following additional folder:</p>
<ul>
<li><p><strong>Revoked Certificates:</strong> If the identity of an actor has been revoked, identifying information about the identity — not the identity itself — is held in this folder. For X.509-based identities, these identifiers are pairs of strings known as Subject Key Identifier (SKI) and Authority Access Identifier (AKI), and are checked whenever the certificate is being used to make sure the certificate has not been revoked.</p>
<p>This list is conceptually the same as a CA’s Certificate Revocation List (CRL), but it also relates to revocation of membership from the organization. As a result, the administrator of a channel MSP can quickly revoke an actor or node from an organization by advertising the updated CRL of the CA. This “list of lists” is optional. It will only become populated as certificates are revoked.</p>
</li>
</ul>
<p>If you’ve read this doc as well as our doc on <a class="reference external" href="../identity/identity.html">Identity</a>, you
should now have a pretty good grasp of how identities and MSPs work in Hyperledger Fabric.
You’ve seen how a PKI and MSPs are used to identify the actors collaborating in a blockchain
network. You’ve learned how certificates, public/private keys, and roots of trust work,
in addition to how MSPs are physically and logically structured.</p>
<!---
Licensed under Creative Commons Attribution 4.0 International License https://creativecommons.org/licenses/by/4.0/
--></div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="../identity/identity.html" title="previous page">Identity</a>
    <a class='right-next' id="next-link" href="../policies/policies.html" title="next page">Policies</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
  </body>
</html>