
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Peer channel-based event services &#8212; hyperledger-fabricdocs master documentation</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Private Data" href="private-data-arch.html" />
    <link rel="prev" title="CouchDB as the State Database" href="couchdb_as_state_database.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="index.html">
    
      <p class="title">hyperledger-fabricdocs</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="intro.html">Introduction</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="whatsnew.html">What’s new in Hyperledger Fabric v2.x</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="key_concepts.html">Key Concepts</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="getting_started.html">Getting Started - Install</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="getting_started_run_fabric.html">Getting Started - Run Fabric</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="developapps/developing_applications.html">Developing Applications</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="tutorials.html">Tutorials</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="deployment_guide_overview.html">Deploying a production network</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="ops_guide.html">Operations Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="upgrade.html">Upgrading to the latest release</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="command_ref.html">Commands Reference</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="architecture.html">Architecture Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="Fabric-FAQ.html">Frequently Asked Questions</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="CONTRIBUTING.html">Contributions Welcome!</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="glossary.html">Glossary</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="releases.html">Releases</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="questions.html">Still Have Questions?</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="status.html">Status</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="http://hyperledger-fabric-ca.readthedocs.io/en/latest">Hyperledger Fabric CA's User Guide</a>
                </li>
            
          
            
                <li class="">
                    <a href="fabric-sdks.html">Hyperledger Fabric SDKs</a>
                </li>
            
          
            
                <li class="">
                    <a href="txflow.html">Transaction Flow</a>
                </li>
            
          
            
                <li class="">
                    <a href="discovery-overview.html">Service Discovery</a>
                </li>
            
          
            
                <li class="">
                    <a href="capability_requirements.html">Defining capability requirements</a>
                </li>
            
          
            
                <li class="">
                    <a href="channels.html">Channels</a>
                </li>
            
          
            
                <li class="">
                    <a href="couchdb_as_state_database.html">CouchDB as the State Database</a>
                </li>
            
          
            
                <li class="active">
                    <a href="">Peer channel-based event services</a>
                </li>
            
          
            
                <li class="">
                    <a href="private-data-arch.html">Private Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="readwrite.html">Read-Write set semantics</a>
                </li>
            
          
            
                <li class="">
                    <a href="gossip.html">Gossip data dissemination protocol</a>
                </li>
            
          
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#general-overview" class="nav-link">General overview</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#available-services" class="nav-link">Available services</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#how-to-register-for-events" class="nav-link">How to register for events</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#overview-of-deliver-response-messages" class="nav-link">Overview of deliver response messages</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#sdk-event-documentation" class="nav-link">SDK event documentation</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="peer-channel-based-event-services">
<h1>Peer channel-based event services<a class="headerlink" href="#peer-channel-based-event-services" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-overview">
<h2>General overview<a class="headerlink" href="#general-overview" title="Permalink to this headline">¶</a></h2>
<p>In previous versions of Fabric, the peer event service was known as the event
hub. This service sent events any time a new block was added to the peer’s
ledger, regardless of the channel to which that block pertained, and it was only
accessible to members of the organization running the eventing peer (i.e., the
one being connected to for events).</p>
<p>Starting with v1.1, there are new services which provide events. These services use an
entirely different design to provide events on a per-channel basis. This means
that registration for events occurs at the level of the channel instead of the peer,
allowing for fine-grained control over access to the peer’s data. Requests to
receive events are accepted from identities outside of the peer’s organization (as
defined by the channel configuration). This also provides greater reliability and a
way to receive events that may have been missed (whether due to a connectivity issue
or because the peer is joining a network that has already been running).</p>
</div>
<div class="section" id="available-services">
<h2>Available services<a class="headerlink" href="#available-services" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Deliver</span></code></p></li>
</ul>
<p>This service sends entire blocks that have been committed to the ledger. If
any events were set by a chaincode, these can be found within the
<code class="docutils literal notranslate"><span class="pre">ChaincodeActionPayload</span></code> of the block.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DeliverWithPrivateData</span></code></p></li>
</ul>
<p>This service sends the same data as the <code class="docutils literal notranslate"><span class="pre">Deliver</span></code> service, and additionally
includes any private data from collections that the client’s organization is
authorized to access.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DeliverFiltered</span></code></p></li>
</ul>
<p>This service sends “filtered” blocks, minimal sets of information about blocks
that have been committed to the ledger. It is intended to be used in a network
where owners of the peers wish for external clients to primarily receive
information about their transactions and the status of those transactions. If
any events were set by a chaincode, these can be found within the
<code class="docutils literal notranslate"><span class="pre">FilteredChaincodeAction</span></code> of the filtered block.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The payload of chaincode events will not be included in filtered blocks.</p>
</div>
</div>
<div class="section" id="how-to-register-for-events">
<h2>How to register for events<a class="headerlink" href="#how-to-register-for-events" title="Permalink to this headline">¶</a></h2>
<p>Registration for events is done by sending an envelope
containing a deliver seek info message to the peer that contains the desired start
and stop positions, the seek behavior (block until ready or fail if not ready).
There are helper variables <code class="docutils literal notranslate"><span class="pre">SeekOldest</span></code> and <code class="docutils literal notranslate"><span class="pre">SeekNewest</span></code> that can be used to
indicate the oldest (i.e. first) block or the newest (i.e. last) block on the ledger.
To have the services send events indefinitely, the <code class="docutils literal notranslate"><span class="pre">SeekInfo</span></code> message should
include a stop position of <code class="docutils literal notranslate"><span class="pre">MAXINT64</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If mutual TLS is enabled on the peer, the TLS certificate hash must be
set in the envelope’s channel header.</p>
</div>
<p>By default, the event services use the Channel Readers policy to determine whether
to authorize requesting clients for events.</p>
</div>
<div class="section" id="overview-of-deliver-response-messages">
<h2>Overview of deliver response messages<a class="headerlink" href="#overview-of-deliver-response-messages" title="Permalink to this headline">¶</a></h2>
<p>The event services send back <code class="docutils literal notranslate"><span class="pre">DeliverResponse</span></code> messages.</p>
<p>Each message contains one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>status – HTTP status code. Each of the services will return the appropriate failure
code if any failure occurs; otherwise, it will return <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">-</span> <span class="pre">SUCCESS</span></code> once
the service has completed sending all information requested by the <code class="docutils literal notranslate"><span class="pre">SeekInfo</span></code>
message.</p></li>
<li><p>block – returned only by the <code class="docutils literal notranslate"><span class="pre">Deliver</span></code> service.</p></li>
<li><p>block and private data – returned only by the <code class="docutils literal notranslate"><span class="pre">DeliverWithPrivateData</span></code> service.</p></li>
<li><p>filtered block – returned only by the <code class="docutils literal notranslate"><span class="pre">DeliverFiltered</span></code> service.</p></li>
</ul>
</div></blockquote>
<p>A filtered block contains:</p>
<blockquote>
<div><ul class="simple">
<li><p>channel ID.</p></li>
<li><p>number (i.e. the block number).</p></li>
<li><p>array of filtered transactions.</p></li>
<li><p>transaction ID.</p>
<ul>
<li><p>type (e.g. <code class="docutils literal notranslate"><span class="pre">ENDORSER_TRANSACTION</span></code>, <code class="docutils literal notranslate"><span class="pre">CONFIG</span></code>).</p></li>
<li><p>transaction validation code.</p></li>
</ul>
</li>
<li><dl class="simple">
<dt>filtered transaction actions.</dt><dd><ul>
<li><dl class="simple">
<dt>array of filtered chaincode actions.</dt><dd><ul>
<li><p>chaincode event for the transaction (with the payload nilled out).</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="sdk-event-documentation">
<h2>SDK event documentation<a class="headerlink" href="#sdk-event-documentation" title="Permalink to this headline">¶</a></h2>
<p>For further details on using the event services, refer to the <a class="reference external" href="https://hyperledger.github.io/fabric-sdk-node/{BRANCH}/tutorial-channel-events.html">SDK documentation.</a></p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="couchdb_as_state_database.html" title="previous page">CouchDB as the State Database</a>
    <a class='right-next' id="next-link" href="private-data-arch.html" title="next page">Private Data</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
  </body>
</html>