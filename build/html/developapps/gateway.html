
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gateway &#8212; hyperledger-fabricdocs master documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials.html" />
    <link rel="prev" title="Wallet" href="wallet.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <p class="title">hyperledger-fabricdocs</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../intro.html">Introduction</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../whatsnew.html">What’s new in Hyperledger Fabric v2.x</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../key_concepts.html">Key Concepts</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../getting_started.html">Getting Started - Install</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../getting_started_run_fabric.html">Getting Started - Run Fabric</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="developing_applications.html">Developing Applications</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../tutorials.html">Tutorials</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../deployment_guide_overview.html">Deploying a production network</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../ops_guide.html">Operations Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../upgrade.html">Upgrading to the latest release</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../command_ref.html">Commands Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../architecture.html">Architecture Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../Fabric-FAQ.html">Frequently Asked Questions</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../CONTRIBUTING.html">Contributions Welcome!</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../glossary.html">Glossary</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../releases.html">Releases</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../questions.html">Still Have Questions?</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../status.html">Status</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="scenario.html">The scenario</a>
                </li>
            
          
            
                <li class="">
                    <a href="analysis.html">Analysis</a>
                </li>
            
          
            
                <li class="">
                    <a href="architecture.html">Process and Data Design</a>
                </li>
            
          
            
                <li class="">
                    <a href="smartcontract.html">Smart Contract Processing</a>
                </li>
            
          
            
                <li class="">
                    <a href="application.html">Application</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="designelements.html">Application design elements</a>
                    <ul>
                    
                        <li class="">
                            <a href="contractname.html">Contract names</a>
                        </li>
                    
                        <li class="">
                            <a href="chaincodenamespace.html">Chaincode namespace</a>
                        </li>
                    
                        <li class="">
                            <a href="transactioncontext.html">Transaction context</a>
                        </li>
                    
                        <li class="">
                            <a href="transactionhandler.html">Transaction handlers</a>
                        </li>
                    
                        <li class="">
                            <a href="endorsementpolicies.html">Endorsement policies</a>
                        </li>
                    
                        <li class="">
                            <a href="connectionprofile.html">Connection Profile</a>
                        </li>
                    
                        <li class="">
                            <a href="connectionoptions.html">Connection Options</a>
                        </li>
                    
                        <li class="">
                            <a href="wallet.html">Wallet</a>
                        </li>
                    
                        <li class="active">
                            <a href="">Gateway</a>
                        </li>
                    
                    </ul>
                </li>
            
          
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#scenario" class="nav-link">Scenario</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#connect" class="nav-link">Connect</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#static" class="nav-link">Static</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#dynamic" class="nav-link">Dynamic</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#multiple-gateways" class="nav-link">Multiple gateways</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="gateway">
<h1>Gateway<a class="headerlink" href="#gateway" title="Permalink to this headline">¶</a></h1>
<p><strong>Audience</strong>: Architects, application and smart contract developers</p>
<p>A gateway manages the network interactions on behalf of an application, allowing
it to focus on business logic. Applications connect to a gateway and then all
subsequent interactions are managed using that gateway’s configuration.</p>
<p>In this topic, we’re going to cover:</p>
<ul class="simple">
<li><p><a class="reference external" href="#scenario">Why gateways are important</a></p></li>
<li><p><a class="reference external" href="#connect">How applications use a gateway</a></p></li>
<li><p><a class="reference external" href="#static">How to define a static gateway</a></p></li>
<li><p><a class="reference external" href="#dynamic">How to define a dynamic gateway for service discovery</a></p></li>
<li><p><a class="reference external" href="#multiple-gateways">Using multiple gateways</a></p></li>
</ul>
<div class="section" id="scenario">
<h2>Scenario<a class="headerlink" href="#scenario" title="Permalink to this headline">¶</a></h2>
<p>A Hyperledger Fabric network channel can constantly change.  The peer, orderer
and CA components, contributed by the different organizations in the network,
will come and go. Reasons for this include increased or reduced business demand,
and both planned and unplanned outages. A gateway relieves an application of
this burden, allowing it to focus on the business problem it is trying to solve.</p>
<p><img alt="gateway.scenario" src="../_images/develop.diagram.25.png" /> <em>A MagnetoCorp and DigiBank
applications (issue and buy) delegate their respective network interactions to
their gateways. Each gateway understands the network channel topology comprising
the multiple peers and orderers of two organizations MagnetoCorp and DigiBank,
leaving applications to focus on business logic. Peers can talk to each other
both within and across organizations using the gossip protocol.</em></p>
<p>A gateway can be used by an application in two different ways:</p>
<ul>
<li><p><strong>Static</strong>: The gateway configuration is <em>completely</em> defined in a <a class="reference external" href="./connectionprofile.html">connection
profile</a>. All the peers, orderers and CAs
available to an application are statically defined in the connection profile
used to configure the gateway. For peers, this includes their role as an
endorsing peer or event notification hub, for example. You can read more about
these roles in the connection profile <a class="reference external" href="./connectionprofile.html">topic</a>.</p>
<p>The SDK will use this static topology, in conjunction with gateway
<a class="reference internal" href="connectionoptions.html"><span class="doc">connection options</span></a>, to manage the transaction
submission and notification processes. The connection profile must contain
enough of the network topology to allow a gateway to interact with the
network on behalf of the application; this includes the network channels,
organizations, orderers, peers and their roles.</p>
</li>
<li><p><strong>Dynamic</strong>: The gateway configuration is minimally defined in a connection
profile. Typically, one or two peers from the application’s organization are
specified, and they use <a class="reference external" href="../discovery-overview.html">service discovery</a> to
discover the available network topology. This includes peers, orderers,
channels, deployed smart contracts and their endorsement policies. (In
production environments, a gateway configuration should specify at least two
peers for availability.)</p>
<p>The SDK will use all of the static and discovered topology information, in
conjunction with gateway connection options, to manage the transaction
submission and notification processes. As part of this, it will also
intelligently use the discovered topology; for example, it will <em>calculate</em>
the minimum required endorsing peers using the discovered endorsement policy
for the smart contract.</p>
</li>
</ul>
<p>You might ask yourself whether a static or dynamic gateway is better? The
trade-off is between predictability and responsiveness. Static networks will
always behave the same way, as they perceive the network as unchanging. In this
sense they are predictable – they will always use the same peers and orderers
if they are available. Dynamic networks are more responsive as they understand
how the network changes – they can use newly added peers and orderers, which
brings extra resilience and scalability, at potentially some cost in
predictability. In general it’s fine to use dynamic networks, and indeed this
the default mode for gateways.</p>
<p>Note that the <em>same</em> connection profile can be used statically or dynamically.
Clearly, if a profile is going to be used statically, it needs to be
comprehensive, whereas dynamic usage requires only sparse population.</p>
<p>Both styles of gateway are transparent to the application; the application
program design does not change whether static or dynamic gateways are used. This
also means that some applications may use service discovery, while others may
not. In general using dynamic discovery means less definition and more
intelligence by the SDK; it is the default.</p>
</div>
<div class="section" id="connect">
<h2>Connect<a class="headerlink" href="#connect" title="Permalink to this headline">¶</a></h2>
<p>When an application connects to a gateway, two options are provided. These are
used in subsequent SDK processing:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span>  <span class="k">await</span> <span class="nx">gateway</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">connectionProfile</span><span class="p">,</span> <span class="nx">connectionOptions</span><span class="p">);</span>
</pre></div>
</div>
<ul>
<li><p><strong>Connection profile</strong>: <code class="docutils literal notranslate"><span class="pre">connectionProfile</span></code> is the gateway configuration that
will be used for transaction processing by the SDK, whether statically or
dynamically. It can be specified in YAML or JSON, though it must be converted
to a JSON object when passed to the gateway:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nx">connectionProfile</span> <span class="o">=</span> <span class="nx">yaml</span><span class="p">.</span><span class="nx">safeLoad</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;../gateway/paperNet.yaml&#39;</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>Read more about <a class="reference external" href="./connectionprofile.html">connection profiles</a> and how
to configure them.</p>
</li>
<li><p><strong>Connection options</strong>: <code class="docutils literal notranslate"><span class="pre">connectionOptions</span></code> allow an application to declare
rather than implement desired transaction processing behaviour. Connection
options are interpreted by the SDK to control interaction patterns with
network components, for example to select which identity to connect with, or
which peers to use for event notifications. These options significantly reduce
application complexity without compromising functionality. This is possible
because the SDK has implemented much of the low level logic that would
otherwise be required by applications; connection options control this logic
flow.</p>
<p>Read about the list of available <a class="reference external" href="./connectionoptions.html">connection options</a>
and when to use them.</p>
</li>
</ul>
</div>
<div class="section" id="static">
<h2>Static<a class="headerlink" href="#static" title="Permalink to this headline">¶</a></h2>
<p>Static gateways define a fixed view of a network. In the MagnetoCorp
<a class="reference external" href="#scenario">scenario</a>, a gateway might identify a single peer from MagnetoCorp,
a single peer from DigiBank, and a MagentoCorp orderer. Alternatively, a gateway
might define <em>all</em> peers and orderers from MagnetCorp and DigiBank. In both
cases, a gateway must define a view of the network sufficient to get commercial
paper transactions endorsed and distributed.</p>
<p>Applications can use a gateway statically by explicitly specifying the connect
option <code class="docutils literal notranslate"><span class="pre">discovery:</span> <span class="pre">{</span> <span class="pre">enabled:false</span> <span class="pre">}</span></code> on the <code class="docutils literal notranslate"><span class="pre">gateway.connect()</span></code> API.
Alternatively, the environment variable setting <code class="docutils literal notranslate"><span class="pre">FABRIC_SDK_DISCOVERY=false</span></code>
will always override the application choice.</p>
<p>Examine the <a class="reference external" href="https://github.com/hyperledger/fabric-samples/blob/%7BBRANCH%7D/commercial-paper/organization/magnetocorp/gateway/networkConnection.yaml">connection
profile</a>
used by the MagnetoCorp issue application. See how all the peers, orderers and
even CAs are specified in this file, including their roles.</p>
<p>It’s worth bearing in mind that a static gateway represents a view of a network
at a <em>moment in time</em>.  As networks change, it may be important to reflect this
in a change to the gateway file. Applications will automatically pick up these
changes when they re-load the gateway file.</p>
</div>
<div class="section" id="dynamic">
<h2>Dynamic<a class="headerlink" href="#dynamic" title="Permalink to this headline">¶</a></h2>
<p>Dynamic gateways define a small, fixed <em>starting point</em> for a network. In the
MagnetoCorp <a class="reference external" href="#scenario">scenario</a>, a dynamic gateway might identify just a
single peer from MagnetoCorp; everything else will be discovered! (To provide
resiliency, it might be better to define two such bootstrap peers.)</p>
<p>If <a class="reference external" href="../discovery-overview.html">service discovery</a> is selected by an
application, the topology defined in the gateway file is augmented with that
produced by this process. Service discovery starts with the gateway definition,
and finds all the connected peers and orderers within the MagnetoCorp
organization using the <a class="reference external" href="../gossip.html">gossip protocol</a>. If <a class="reference external" href="../glossary.html#anchor-peer">anchor
peers</a> have been defined for a channel, then
service discovery will use the gossip protocol across organizations to discover
components within the connected organization. This process will also discover
smart contracts installed on peers and their endorsement policies defined at a
channel level. As with static gateways, the discovered network must be
sufficient to get commercial paper transactions endorsed and distributed.</p>
<p>Dynamic gateways are the default setting for Fabric applications. They can be
explicitly specified using the connect option <code class="docutils literal notranslate"><span class="pre">discovery:</span> <span class="pre">{</span> <span class="pre">enabled:true</span> <span class="pre">}</span></code> on
the <code class="docutils literal notranslate"><span class="pre">gateway.connect()</span></code> API. Alternatively, the environment variable setting
<code class="docutils literal notranslate"><span class="pre">FABRIC_SDK_DISCOVERY=true</span></code> will always override the application choice.</p>
<p>A dynamic gateway represents an up-to-date view of a network. As networks
change, service discovery will ensure that the network view is an accurate
reflection of the topology visible to the application. Applications will
automatically pick up these changes; they do not even need to re-load the
gateway file.</p>
</div>
<div class="section" id="multiple-gateways">
<h2>Multiple gateways<a class="headerlink" href="#multiple-gateways" title="Permalink to this headline">¶</a></h2>
<p>Finally, it is straightforward for an application to define multiple gateways,
both for the same or different networks. Moreover, applications can use the name
gateway both statically and dynamically.</p>
<p>It can be helpful to have multiple gateways. Here are a few reasons:</p>
<ul class="simple">
<li><p>Handling requests on behalf of different users.</p></li>
<li><p>Connecting to different networks simultaneously.</p></li>
<li><p>Testing a network configuration, by simultaneously comparing its behaviour
with an existing configuration.</p></li>
</ul>
<!--- Licensed under Creative Commons Attribution 4.0 International License
https://creativecommons.org/licenses/by/4.0/ --></div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="wallet.html" title="previous page">Wallet</a>
    <a class='right-next' id="next-link" href="../tutorials.html" title="next page">Tutorials</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
  </body>
</html>